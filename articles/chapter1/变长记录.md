<p>
    变长记录：
</p>
<p>
    虽然使用固定的记录格式简单直观，但实际上，我们更希望：
</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
    <li>
        <p>
            <strong>存储大小变化的数据项</strong>：譬如上一节提到的文章，这样有助于节约空间，提高利用率。
        </p>
    </li>
    <li>
        <p>
            <strong>重复字段</strong>：如果在一条记录内存储表示多对多的关系，那么有多少个对象被关联，我们就需要存储多少个对象的引用。<br/>
        </p>
    </li>
    <li>
        <p>
            <strong>可变格式的字段</strong>：譬如xml格式，我们在用xml表示记录时，由于它极高的自由度，就导致了可能会允许有多个重复的字段或者可选的属性。
        </p>
    </li>
    <li>
        <p>
            <strong>极大的字段</strong>：比如静态文件，blob对象，那就需要单独存储了，而他们通常又关联着一些小字段，譬如图片的id、上传者、上传时间、文件名等。
        </p>
    </li>
</ol>
<p>
    那么相对于定长记录，变长记录的处理难度显然要高许多，我们慢慢讨论。<br/>
</p>
<p>
    &nbsp; &nbsp; &nbsp; &nbsp;首先是记录格式，原来记录的有效信息位（如第几个字节到第几个字节是什么信息是确定的）全部合并，具体的内容区分则由信息头的记录指针决定，来解析出具体的记录内容。顺带一提，大多数数据库都允许NULL值的存在，而在数据库中，变长记录的NULL往往是不需要为其分配存储空间的，只需要在指针处定好自己的标记规则即可。
</p>
<p>
    <strong>具有重复字段的记录</strong>
</p>
<p>
    <strong>&nbsp; &nbsp; &nbsp; &nbsp;</strong>有时会出现这么一种情况，譬如有一张表：制片人、属于这个人的电影（有n个，n不确定但长度确定）。那么在定长的前提下，只需要记录n的个数及指针，解析时按偏移量处理即可。而另一种方法则直接把记录的值存储在另一个块中，在记录块中存储好指针即可。但这样无疑增加了io的次数，效率会大打折扣。<strong><br/></strong>
</p>
<p>
    &nbsp; &nbsp;于是一个折中的方案是：<br/>
</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
    <li>
        <p>
            重复字段次数合理出现。
        </p>
    </li>
    <li>
        <p>
            指向可以找到这个重复字段其他地方出现实例的指针。
        </p>
    </li>
    <li>
        <p>
            其他地方出现的次数。
        </p>
    </li>
</ol>
<p>
    如果所需要的空间小于预留空间，则一些空间可能无用。如果信息不能放入定长部分，则指向附加空间的指针非空，且我们能够通过跟踪这个指针找到重复字段另外的出现。<br/>
</p>
<p>
    <strong>可变格式的记录</strong>
</p>
<p>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;在可变格式下，由于记录没有固定的格式，情况便会变得更加复杂。譬如尝试用记录来表示xml格式的元素，如：医院有许多检查，检查属于很多部门，你需要做一些特定的检查，存储并输出他们就会变得很困难。<strong><br/></strong>
</p>
<p>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 可变格式记录最简单的表示是带标记的字段序列，每个带标记的字段由字段值以及置于字段值之前额关于这个字段的角色信息，诸如：<br/>
</p>
<ol class=" list-paddingleft-2" style="list-style-type: decimal;">
    <li>
        <p>
            属性或者字段名。
        </p>
    </li>
    <li>
        <p>
            字段类型。
        </p>
    </li>
    <li>
        <p>
            字段长度。
        </p>
    </li>
</ol>
<p>
    <strong>无法装入一个块的对象</strong>
</p>
<p>
    跨块存储，以及blob对象，快下班了，以后看情况更新。<br/>
</p>